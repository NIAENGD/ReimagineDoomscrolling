(function(){"use strict";const h={env:{NODE_ENV:"production"}};var r=(e=>(e.CLAUDE="claude",e.CHATGPT="chatgpt",e.GEMINI="gemini",e.DEEPSEEK="deepseek",e.GROK="grok",e))(r||{});const s=750,u={[r.CLAUDE]:'div[contenteditable="true"].ProseMirror',[r.CHATGPT]:'div[contenteditable="true"].ProseMirror',[r.GEMINI]:'div[contenteditable="true"][class*="textarea"]',[r.DEEPSEEK]:"#chat-input",[r.GROK]:"textarea"};function i(e){const t=new URL(e);if(t.hostname.includes("claude"))return r.CLAUDE;if(t.hostname.includes("chatgpt"))return r.CHATGPT;if(t.hostname.includes("gemini"))return r.GEMINI;if(t.hostname.includes("deepseek"))return r.DEEPSEEK;if(t.hostname.includes("grok"))return r.GROK;throw new Error("Invalid chatbot url")}async function E(e,t){try{const n=document.querySelector(u[e]);if(!n)throw new Error("Editor not found");switch(e){case r.GROK:case r.DEEPSEEK:{const o=n;o.value=t,a(o);break}case r.GEMINI:{n.textContent=t,a(n);const o=document.querySelector('button[data-testid="send-button"]');o&&o.click();break}case r.CLAUDE:case r.CHATGPT:{n.querySelector("p.is-empty")&&(n.innerHTML="");const c=document.createElement("p");c.textContent=t,n.appendChild(c),a(n);break}}}catch(n){console.error("Paste error:",n),alert("Oops! We encountered a small hiccup while trying to paste your text. Could you please try once more?")}}function a(e){e.dispatchEvent(new InputEvent("input",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),setTimeout(()=>{const t=l();e.dispatchEvent(t),document.dispatchEvent(t)},s)}function l(){return new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,which:13,bubbles:!0,cancelable:!0,composed:!0,shiftKey:!1,metaKey:!1,ctrlKey:!1})}async function d(){try{const e=await chrome.storage.sync.get({summarizeCount:0,has_given_review:!1}),t=e.summarizeCount+1,n={summarizeCount:t};!e.has_given_review&&(t===20||t===50||t===80)&&(n.show_give_review=!0),await chrome.storage.sync.set(n)}catch(e){console.error("Failed to increment summarize count:",e)}}chrome.runtime.onMessage.addListener(e=>{if(e.type==="FROM_BACKGROUND"&&e.action==="pasteText"){const t=i(e.data.url);setTimeout(async()=>{const n=await chrome.runtime.sendMessage({type:"RETRIEVE_TEXT"});if(!(n!=null&&n.text))throw new Error("No text found for transfer");await E(t,n.text),await d()},t===r.GROK?1500:500)}})})();
